!function(t){"use strict";t.HSCore.components.HSCountdown={_baseConfig:{yearsElSelector:".years",monthElSelector:".month",daysElSelector:".days",hoursElSelector:".hours",minutesElSelector:".minutes",secondsElSelector:".seconds",circles:!1,wrpClass:"wrpClass",textClass:"textClass",valueStrokeClass:"valueStrokeClass",maxValueStrokeClass:"maxValueStrokeClass",styleWrapper:"styleWrapper",styleText:"styleText"},pageCollection:t(),_circlesIds:[0],init:function(e,a){if(this.collection=e&&t(e).length?t(e):t(),t(e).length)return this.config=a&&t.isPlainObject(a)?t.extend({},this._baseConfig,a):this._baseConfig,this.config.itemSelector=e,this.initCountdowns(),this.pageCollection},initCountdowns:function(){var e=this;this.collection.each(function(a,s){var i=t(s),l={endDate:i.data("end-date")?new Date(i.data("end-date")):new Date,startDate:i.data("start-date")?new Date(i.data("start-date")):new Date,yearsEl:i.find(e.config.yearsElSelector),yearsFormat:i.data("years-format"),monthEl:i.find(e.config.monthElSelector),monthFormat:i.data("month-format"),daysEl:i.find(e.config.daysElSelector),daysFormat:i.data("days-format"),hoursEl:i.find(e.config.hoursElSelector),hoursFormat:i.data("hours-format"),minutesEl:i.find(e.config.minutesElSelector),minutesFormat:i.data("minutes-format"),secondsEl:i.find(e.config.secondsElSelector),secondsFormat:i.data("seconds-format")};e.config.circles&&i.data("start-date")?e._initPiesImplementation(i,l):e._initBaseImplementation(i,l),e.pageCollection=e.pageCollection.add(i)})},_initBaseImplementation:function(t,e){t.countdown(e.endDate,function(t){e.yearsEl.length&&e.yearsEl.text(t.strftime(e.yearsFormat)),e.monthEl.length&&e.monthEl.text(t.strftime(e.monthFormat)),e.daysEl.length&&e.daysEl.text(t.strftime(e.daysFormat)),e.hoursEl.length&&e.hoursEl.text(t.strftime(e.hoursFormat)),e.minutesEl.length&&e.minutesEl.text(t.strftime(e.minutesFormat)),e.secondsEl.length&&e.secondsEl.text(t.strftime(e.secondsFormat))})},_initPiesImplementation:function(t,e){e.yearsEl.length&&this._preparePieItem(e.yearsEl,{maxValue:e.endDate.getFullYear()-e.startDate.getFullYear(),radius:t.data("circles-radius"),width:t.data("circles-stroke-width"),"fg-color":t.data("circles-fg-color"),"bg-color":t.data("circles-bg-color"),"additional-text":t.data("circles-additional-text"),"font-size":t.data("circles-font-size")}),e.monthEl.length&&this._preparePieItem(e.monthEl,{maxValue:Math.round(Math.abs((e.endDate.getTime()-e.startDate.getTime())/864e5))/12,radius:t.data("circles-radius"),width:t.data("circles-stroke-width"),"fg-color":t.data("circles-fg-color"),"bg-color":t.data("circles-bg-color"),"additional-text":t.data("circles-additional-text"),"font-size":t.data("circles-font-size")}),e.daysEl.length&&this._preparePieItem(e.daysEl,{maxValue:this._getDaysMaxValByFormat(e.daysFormat,e.startDate,e.endDate),radius:t.data("circles-radius"),width:t.data("circles-stroke-width"),"fg-color":t.data("circles-fg-color"),"bg-color":t.data("circles-bg-color"),"additional-text":t.data("circles-additional-text"),"font-size":t.data("circles-font-size")}),e.hoursEl.length&&this._preparePieItem(e.hoursEl,{maxValue:60,radius:t.data("circles-radius"),width:t.data("circles-stroke-width"),"fg-color":t.data("circles-fg-color"),"bg-color":t.data("circles-bg-color"),"additional-text":t.data("circles-additional-text"),"font-size":t.data("circles-font-size")}),e.minutesEl.length&&this._preparePieItem(e.minutesEl,{maxValue:60,radius:t.data("circles-radius"),width:t.data("circles-stroke-width"),"fg-color":t.data("circles-fg-color"),"bg-color":t.data("circles-bg-color"),"additional-text":t.data("circles-additional-text"),"font-size":t.data("circles-font-size")}),e.secondsEl.length&&this._preparePieItem(e.secondsEl,{maxValue:60,radius:t.data("circles-radius"),width:t.data("circles-stroke-width"),"fg-color":t.data("circles-fg-color"),"bg-color":t.data("circles-bg-color"),"additional-text":t.data("circles-additional-text"),"font-size":t.data("circles-font-size")}),t.countdown(e.endDate,function(t){e.yearsEl.length&&e.yearsEl.data("circle").update(t.strftime(e.yearsFormat)),e.monthEl.length&&e.monthEl.data("circle").update(t.strftime(e.monthFormat)),e.daysEl.length&&e.daysEl.data("circle").update(t.strftime(e.daysFormat)),e.hoursEl.length&&e.hoursEl.data("circle").update(t.strftime(e.hoursFormat)),e.minutesEl.length&&e.minutesEl.data("circle").update(t.strftime(e.minutesFormat)),e.secondsEl.length&&e.secondsEl.data("circle").update(t.strftime(e.secondsFormat))})},_preparePieItem:function(t,e){var a=this._circlesIds[this._circlesIds.length-1]+1;this._circlesIds.push(a),t.attr("id","hs-countdown-element-"+a),t.data("circle",Circles.create({id:"hs-countdown-element-"+a,radius:e.radius||80,value:0,maxValue:e.maxValue||100,width:e.width||10,text:function(t){return t+(e["additional-text"]||"")},colors:[e["bg-color"]||"#eeeeee",e["fg-color"]||"#72c02c"],duration:0,wrpClass:this.config.wrpClass,textClass:this.config.textClass,valueStrokeClass:this.config.valueStrokeClass,maxValueStrokeClass:this.config.maxValueStrokeClass,styleWrapper:this.config.styleWrapper,styleText:this.config.styleText})),e["font-size"]&&t.find("."+this.config.textClass).css("font-size",e["font-size"]+"px")},_getDaysMaxValByFormat:function(t,e,a){switch(t){case"%D":return Math.round(Math.abs((a.getTime()-e.getTime())/864e5));default:return 31}}}}(jQuery);